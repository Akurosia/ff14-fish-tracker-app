<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="A web version of the FF14 Fish Guide." />
    <meta name="author" content="Carbuncle Plushy (Balmung)" />

    <link rel="icon" type="image/png" href="favicon.png" />

    <title>FFX|V Fish Guide</title>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-142180509-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-142180509-1');
    </script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.11/semantic.css" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dot/1.1.2/doT.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twix.js/1.1.5/twix.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/date-fns/1.28.5/date_fns.min.js"></script>
    <script src="js/lib/dateFns.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.11/semantic.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/rxjs/6.5.2/rxjs.umd.min.js"></script>

    <link rel="stylesheet" href="public/images/sprite.css" />
    <link rel="stylesheet" href="css/semantic_ui_overrides.css" />
    <link rel="stylesheet" href="css/overlay.css" />
    <link rel="stylesheet" href="css/dark_overlay.css" />

    <!-- Localization Support script -->
    <script type="text/javascript" src="js/app/localization.js"></script>
    <!-- Include the data -->
    <script type="text/javascript" src="js/app/data.js"></script>
    <script type="text/javascript" src="js/app/time.js"></script>
    <script type="text/javascript" src="js/app/weather.js"></script>
    <script type="text/javascript" src="js/app/fish_info_data.js"></script>

    <script type="text/javascript" src="js/app/fishguide.js"></script>

    <script type="text/javascript">
      const { interval } = rxjs;
      const { timestamp, skip } = rxjs.operators;

      $(() => {
        // Main header needs to display the current time.
        interval(1000 /*ms*/).pipe(
          timestamp()
        ).subscribe(x => {
          // Update the main header's earth and eorzea times.
          $("#earthClock").text(dateFns.format(x.timestamp, "dddd, MMMM Do YYYY, h:mm:ss a"));
          $("#eorzeaClock").text(moment.utc(eorzeaTime.toEorzea(x.timestamp)).format("HH:mm"));
        });
        let siteTheme = 'dark';
        if ('fishTrackerSettings' in window.localStorage) {
          siteTheme = JSON.parse(window.localStorage.fishTrackerSettings).theme;
        } else if ('theme' in window.localStorage) {
          siteTheme = window.localStorage.theme;
        }

        function applyTheme(theme) {
          if (theme === 'dark') {
            $('body').addClass('dark');
            $('*[data-tooltip]').attr('data-inverted', '');
          } else {
            $('body').removeClass('dark');
            $('*[data-tooltip]').removeAttr('data-inverted');
          }

          $('.ui.container').toggleClass('inverted', theme === 'dark');
          $('.ui.form').toggleClass('inverted', theme === 'dark');
          $('.ui.segment').toggleClass('inverted', theme === 'dark');
          $('.ui.table').toggleClass('inverted', theme === 'dark');
          $('.ui.list').toggleClass('inverted', theme === 'dark');
          $('.ui.top.attached.label').toggleClass('black', theme === 'dark');
          $('.ui.menu').toggleClass('inverted', theme === 'dark');
          $('.ui.modal').toggleClass('inverted', theme === 'dark');
        }

        function themeButtonClicked(e) {
          if (e) e.stopPropagation();
          let $this = $(this);
          siteTheme = $this.prop('checked') ? 'dark' : 'light';
          applyTheme(siteTheme);
        }

        // Render the fish guide from template.
        FishGuide.render(document.getElementById('fishGuideElem'));

        // Set the theme.
        $('#theme-button').prop('checked', siteTheme === 'dark');
        $('#theme-button').on('click', themeButtonClicked);
        applyTheme(siteTheme);

        $('#displayFishGuideButton').on('click', function(e) {
          if (e) e.stopPropagation();
          $('#fishGuideModal').modal('show');
        });
      });
    </script>
  </head>
  <body>
    <div id="topmenu" class="ui text top fixed menu">
      <div class="ui container">
        <div class="header item">FFX|V Fish Guide</div>
        <div class="right item">
          <b>Current Time:</b>&nbsp;<span id="eorzeaClock">##:##</span>&nbsp;(<span id="earthClock">#########</span>)
          <div id="theme-toogle" class="ui toggle checkbox">
            <input type="checkbox" name="theme-button" id="theme-button">
            <label></label>
          </div>
        </div>
      </div>
    </div>
    <div class="ui main container">
      <h1>FFX|V Fish Guide</h1>
      <div class="ui container">
        <div class="ui longer modal" id="fishGuideModal">
          <div class="scrolling content" id="fishGuideElem"></div>
        </div>

        <div class="ui button" id="displayFishGuideButton">Display Fish Guide</div>

        <p>
          FINAL FANTASY is a registered trademark of Square Enix Holdings Co., Ltd.<br/>
          FINAL FANTASY XIV Â© 2010 - 2019 SQUARE ENIX CO., LTD. All Rights Reserved.
        </p>
      </div>
    </div>
    <div class="ui bottom fixed menu">
      <div class="right menu">
        <a class="icon item" href="https://discord.gg/AnFaDpN" data-tooltip="Fisherman's Horizon Discord" data-position="top right" target="_blank">
          <i class="discord icon"></i>
        </a>
        <a class="icon item" href="https://twitter.com/CarbunclePlushy" data-tooltip="Twitter" data-position="top right" target="_blank">
          <i class="twitter icon"></i>
        </a>
        <a class="icon item" href="https://github.com/icykoneko/ff14-fish-tracker-app" data-tooltip="Github" data-position="top right" target="_blank">
          <i class="github icon"></i>
        </a>
      </div>
    </div>
  </body>
</html>